Use SetWindowsHookEx instead of timer.